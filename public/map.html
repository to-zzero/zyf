<!DOCTYPE html>
<html>

<head>
    <!-- Load Leaflet from CDN -->
    <link rel="stylesheet" href="./css/leaflet.css" />
    <script src="./js/leaflet.js"></script>

    <!-- Load Esri Leaflet from CDN -->
    <script src="./js/esri-leaflet.js"></script>

    <style>
        html,
        body,
        #map {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="map"></div>
    <script>
        var search = window.location.search.substr(1)
        var obj = {}
        search.split('&').map(r => {
            var pair = r.split('=')
            obj[pair[0]] = pair[1]
        })

        console.log(obj.proxy)
        console.log(obj.service)

        var map = L.map('map').setView([36.528, 108.680], 3);
        L.esri.basemapLayer("Gray").addTo(map);

        // new L.esri
        //     .TiledMapLayer({ url: 'https://services.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer' })
        //     .addTo(map)

        new L.esri
            .TiledMapLayer({ url: `/rest/services/${obj.service}` })
            .addTo(map)




    </script>
</body>

</html>